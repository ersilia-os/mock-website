<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Ersilia Open Source Initiative</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- favicon -->
        <link rel="shortcut icon" href="images/ersilia/EOSI_LogoGreenRound.png">
        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <!-- Icons -->
        <link href="css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
        <link href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" rel="stylesheet">
        <!-- Main Css -->
        <link href="css/style.css" rel="stylesheet" type="text/css" id="theme-opt" />
        <link href="css/colors/default.css" rel="stylesheet" id="color-opt">
        <link href="css/custom.css" rel="stylesheet">
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700;800&display=swap" rel="stylesheet">
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		
		<script>
			$(document).ready(function(){
				var x = 0;
				
				$("#addmore").click(function(){
					$("#smiles-container").prepend("<div class='row mt-4' id=formrow"+x+"><div class='col-md-6'><input type='text' class='form-control text-gray' placeholder='Enter SMILES here' required=''></div><div class='col-md-6'><button class='btn btn-red btn-removesmiles' id='"+x+"'>Remove</button></div></div>");
					x=x+1;
				});			
				
				$(document).on("click", ".btn-removesmiles" , function() {
				            $(this).parent().parent().remove();
				        });
				
			});
		</script>
			
		<!-- Start of RDKIT JS Code -->
		<script src="https://unpkg.com/@rdkit/rdkit/Code/MinimalLib/dist/RDKit_minimal.js"></script>
		<script>
		  onRuntimeInitialized: initRDKitModule().then(function(instance) {
		    RDKitModule = instance;
		    console.log('version: ' + RDKitModule.version());
		    var m1 = RDKitModule.get_mol("c1ccccc1O");
		    console.log('smiles: ' + m1.get_smiles());
		    m1.delete();
		    callback("");
		  });
		  function form_to_details(details) {
		    var controls = ["addAtomIndices", "addBondIndices", "explicitMethyl", "addStereoAnnotation"];
		    for (i in controls) {
		      var control = controls[i];
		      details[control] = document.getElementById(control).checked
		    }
		    var texts = ["legend", "bondLineWidth", "legendFontSize"];
		    for (i in texts) {
		      var control = texts[i];
		      details[control] = document.getElementById(control).value
		    }
		  }
		  function draw_with_highlights(mol, details) {
		    form_to_details(details);
		    var tdetails = JSON.stringify(details)
		    var svg = mol.get_svg_with_highlights(tdetails);
		    if (svg == "") return;
		    var ob = document.getElementById("drawing");
		    ob.outerHTML = "<div id='drawing'>" + svg + "</div>";
		    var canvas = document.getElementById("rdkit-canvas");
		    mol.draw_to_canvas_with_highlights(canvas, tdetails);

		  }
		  function draw(mol) {
		    var details = {};
		    draw_with_highlights(mol, details);
		    return;
		    var svg = mol.get_svg();
		    if (svg == "") return;
		    var ob = document.getElementById("drawing");
		    ob.outerHTML = "<div id='drawing'>" + svg + "</div>";
		    var canvas = document.getElementById("rdkit-canvas");
		    mol.draw_to_canvas(canvas, -1, -1);
		  }
		  function callback(text, update_descrs) {
		    var mol = RDKitModule.get_mol(text);
		    if (mol.is_valid()) {
		      draw(mol);
		      var ob = document.getElementById("can_smiles");
		      ob.outerHTML = "<div id='can_smiles'>" + mol.get_smiles() + "</div>";
		      if (update_descrs) {
		        var descrs = JSON.parse(mol.get_descriptors());
		        var db = document.getElementById("descrs");
		        db.outerHTML = "<div id='descrs'>" +
		          "<b>AMW:</b> " + descrs.amw +
		          "<br /><b>MolLogP:</b> " + descrs.CrippenClogP +
		          "<br /><b>MFP2:</b> " + mol.get_morgan_fp(2, 128) +
		          "</div>";
		      }
		    }
		    mol.delete();
		  }
		  function sma_callback(text) {
		    var qmol = RDKitModule.get_qmol(text);
		    var mol = RDKitModule.get_mol(document.getElementById("smiles_input").value);
		    if (mol.is_valid() && qmol.is_valid()) {
		      var mdetails = mol.get_substruct_match(qmol);
		      var match = JSON.parse(mdetails);
		      if (match.atoms && match.atoms.length) draw_with_highlights(mol, match);
		    }
		    mol.delete();
		    qmol.delete();
		  }
		  function template_callback(text) {
		    if(text==""){
		      text = document.getElementById("template_input").value;
		    }
		    var qmol = RDKitModule.get_mol(text);
		    var mol = RDKitModule.get_mol(document.getElementById("smiles_input").value);
		    if (mol.is_valid() && qmol.is_valid()) {
		      var mdetails = mol.get_substruct_match(qmol);
		      var match = JSON.parse(mdetails);
		      var useCoordgen = document.getElementById("useCoordgen").checked;
		      mol.generate_aligned_coords(qmol,useCoordgen);
		      if (match.atoms && match.atoms.length) draw_with_highlights(mol, match);
		    }
		    mol.delete();
		    qmol.delete();
		  }
		  function option_changed(cb) {
		    var smi = document.getElementById('smiles_input').value;
		    var sma = document.getElementById('smarts_input').value;
		    if (sma) {
		      sma_callback(sma);
		    } else {
		      callback(smi, false);
		    }
		  }
		  function abbreviation_option_changed(cb) {
		    var smi = document.getElementById('smiles_input').value;
		    var mol = RDKitModule.get_mol(smi);
		    if(document.getElementById('useAbbreviations').checked){
		      var useLinkers = document.getElementById('useLinkers').checked;
		      var maxCoverage = +(document.getElementById('maxCoverage').value);
		      mol.condense_abbreviations(maxCoverage,useLinkers);
		    }
		    draw(mol);
		  }
		</script>
    </head>

    <body>
        <!-- Navbar STart -->
        <header id="topnav" class="defaultscroll sticky">
            <div class="container">
                <!-- Logo container-->
                <div>
                    <a class="logo" href="index-ersilia.html">
                        <img src="images/ersilia/Ersilia_Plum.png" width="150" height="41">
                    </a>
                </div>                 
                <!-- End Logo container-->
        
            </div><!--end container-->
        </header><!--end header-->
        <!-- Navbar End -->

        <!-- Hero Start -->
        <section class="d-table w-100">
            <div class="container margin-top-150">
                <div class="row mb-4">
							<div class="col-md-3 text-purple page-header">Model Selected:</div>
                            <div class="col-md-9">
									<div class="row">
										<div class="col-md-6">
		                                    <div class="mb-0 text-purple page-header">
		                                        Antimalarial OSM
		                                    </div>
											<span class="text-red">2022, Ersilia Open Source Initiative</span>
										</div>
										<div class="col-md-6">
											<button class="btn btn-yellow">Select Another Model</button>
										</div>
									</div>
                            </div>
                </div><!--end row-->
				
				<h5 class="title mt-4 text-gray">Type in your SMILES</h5>
					<div class="row">
					<div class="col-md-6">
							<div id="smiles-container">
								<div class="row mt-4">
						
									<div class="col-md-6">
										<input class="form-control text-gray" id="smiles_input" type="text" value="" onkeyup="callback(this.value,true)" required="">
									</div>
									<div class="col-md-6">
			                        	<button class="btn btn-green" id="addmore">+ Add More</button>
			                        </div>
								</div>
							</div>
				
								<div class="row margin-top-40">
						
								<div class="col-md-6">
		                    		<a href="fileuploaded.html"><button class="btn btn-secondary">Upload CSV File</button></a>
							
									<button class="btn btn-secondary">Download Example CSV</button>

								</div>
								</div>
						
								<div class="row margin-top-40">
				
								<div class="col-md-6">
		                    		<a href="sendmeresults.html"><button class="btn btn-primary">Start Processing SMILES</button></a>
								</div>
				
								<div class="row margin-top-150"></div>

								</div>
					</div>
					<div class="col-md-6">

					    <div id="canvas-div">
					      <canvas id="rdkit-canvas" width="400" height="300">
					      </canvas>
					      <br />
						  <div style="display: none;">
						      <input type="checkbox" id="addAtomIndices" name="atomIndices" onclick="option_changed(this);">
						      <label for="addAtomIndices">atomIndices</label>
						      <input type="checkbox" id="addBondIndices" name="bondIndices" onclick="option_changed(this);">
						      <label for="addBondIndices">bondIndices</label>
						      <input type="checkbox" id="addStereoAnnotation" name="addStereoAnnotation" onclick="option_changed(this);">
						      <label for="addStereoAnnotation">addStereoAnnotation</label>
						      <br />
						      <input type="checkbox" id="explicitMethyl" name="explicitMethyl" onclick="option_changed(this);" />
						      <label for="explicitMethyl">explicitMethyl</label>
						      <br />
						      <input type="text" id="legend" onkeyup="option_changed(this);"><label for="legend">legend</label>
						      <input type="text" id="legendFontSize" onkeyup="option_changed(this);"><label
						        for="legendFontSize">legendFontSize</label>
						      <br />
						      <input type="number" id="bondLineWidth" onkeyup="option_changed(this);"><label
						        for="bondLineWidth">bondLineWidth</label>
							</div>

					    </div>
					    <div id="molecule" style="display: none;">
					      <div id="drawing"></div>
					      <div id="can_smiles"></div>
					    </div>
					</div>
				</div>
						
            </div><!--end container-->
        </section><!--end section-->
        <!-- Hero End -->

									
        <!-- Footer Start -->
        <footer class="bg-footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3 mb-0 mb-md-4 pb-0 pb-md-2">
                        <a href="#" class="logo-footer">
                            <img src="images/ersilia/EOSI_LogoGreenRound.png" height="48" alt="">
                        </a>
                        <ul class="list-unstyled footer-list px-0 mt-4">
                            <li><i data-feather="map-pin" class="fea icon-sm me-2"></i><a href="#" class="text-foot">Cambridge, UK</a></li>
                            <li><i data-feather="mail" class="fea icon-sm me-2"></i><a href="mailto:hello@ersilia.io" class="text-foot">hello@ersilia.io</a></li>
                        </ul>
                    </div><!--end col-->

                    <div class="col-lg-9 col-md-12">
                        <div class="row">
                            <div class="col-md-3 col-6 mt-4 mt-sm-0 pt-2 pt-sm-0">
                                <h5 class="footer-head">Ersilia</h5>
                                <ul class="list-unstyled footer-list mt-4">
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> About us</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Team</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Projects</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Blog</a></li>
                                </ul>
                            </div><!--end col-->
                            
                            <div class="col-md-3 col-6 mt-4 mt-sm-0 pt-2 pt-sm-0">
                                <h5 class="footer-head">Help</h5>
                                <ul class="list-unstyled footer-list mt-4">
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Request a model</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Email</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> FAQ</a></li>
                                </ul>
                            </div><!--end col-->
                            
                            <div class="col-md-3 col-6 mt-4 mt-sm-0 pt-2 pt-sm-0">
                                <h5 class="footer-head">Documentation</h5>
                                <ul class="list-unstyled footer-list mt-4">
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Support</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Docs</a></li>
                                </ul>
                            </div><!--end col-->
                            
                            <div class="col-md-3 col-6 mt-4 mt-sm-0 pt-2 pt-sm-0">
                                <h5 class="footer-head">Support us</h5>
                                <ul class="list-unstyled footer-list mt-4">
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Donate</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Volunteer</a></li>
                                    <li><a href="javascript:void(0)" class="text-foot"><i class="mdi mdi-chevron-right me-1"></i> Code with us</a></li>
                                </ul>
                            </div><!--end col-->
                        </div><!--end row-->
                    </div><!--end col-->
                </div><!--end row-->
            </div><!--end container-->

            <div class="container mt-5">
                <div class="pt-4 footer-bar">
                    <div class="row align-items-center">
                        <div class="col-sm-6">
                            <div class="text-sm-start text-center">
                                <ul class="list-unstyled social-icon social mb-0 mt-4 mt-sm-0">
                                    <li class="list-inline-item"><a href="javascript:void(0)" class="rounded"><i data-feather="twitter" class="fea icon-sm fea-social"></i></a></li>
                                    <li class="list-inline-item"><a href="javascript:void(0)" class="rounded"><i data-feather="linkedin" class="fea icon-sm fea-social"></i></a></li>
                                    <li class="list-inline-item"><a href="javascript:void(0)" class="rounded"><i data-feather="github" class="fea icon-sm fea-social"></i></a></li>
                                </ul><!--end icon-->
                            </div>
                        </div>
    
                        <div class="col-sm-6 mt-4 mt-sm-0">
                            <ul class="list-unstyled footer-list text-sm-end text-center mb-0">
                                <li class="list-inline-item"><a href="javascript:void(0)" class="text-foot me-2">Charity Commission for England and Wales 1192266</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="row justify-content-center mt-4">
                        <div class="col-12 text-center">
                            <p class="mb-0">© <script>document.write(new Date().getFullYear())</script> Ersilia Open Source Initiative </p>
                        </div>
                    </div>
                </div>
            </div>
        </footer><!--end footer-->
        <!-- Footer End -->


        <!-- Back to top -->
        <a href="#" class="btn btn-icon btn-pills btn-primary back-to-top" id="back-to-top"><i data-feather="arrow-up" class="icons"></i></a>
        <!-- Back to top -->
		

                <!-- Modal Content Start -->
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title text-purple">Antimalarial OSM (eos3ght)</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="modalmodeldesc text-gray">Bioactivity signatures of small molecules</div>
								<div class="modalmodelauthor">2022, Ersilia Open Source Initiative.</div>
								<div class="sectiontitle">Description</div>
								<div class="sectionbody">Prediction of the activity against Plasmodium Falciparum in blood stages in vitro due to inhibition of the  PfATPase</div>
								<div class="sectiontitle">Output</div>
								<div class="sectionbody">Inhibitory Concentration 50% (uM)</div>
								<div class="sectiontitle">Dataset</div>
								<div class="sectionbody">Open Source Malaria Series 4 (324 compounds with a triazolopyrazine core) <a href="#" target="_blank" class="text-purple">Link to Source</a></div>
								<div class="row">
									<div class="col-md-4">
										<div class="sectiontitle">Authors</div>
										<div class="sectionbody">Ersilia Open Source Initiative</div>
									</div>
									<div class="col-md-4">
										<div class="sectiontitle">License</div>
										<div class="sectionbody">GPLv3</div>
									</div>
									<div class="col-md-4">
										<div class="sectiontitle">Tags</div>
										<div class="sectionbody"><span class="indimodeltags tag-purple">tag 1</span><span class="indimodeltags tag-yellow">tag 2</span><span class="indimodeltags tag-green">tag 3</span></div>
									</div>
								</div>
                            </div>
								
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Select This Model</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Content End -->
            </div>
        </div><!--end col-->

        
        <!-- javascript -->
        <script src="js/bootstrap.bundle.min.js"></script>
        <!-- Icons -->
        <script src="js/feather.min.js"></script>
        <!-- Main Js -->
        <script src="js/app.js"></script>
		
		<script>
			$(".btn-removesmiles").click(function(){
				console.log("clicked");
			    removeSmilesRow($(this).attr('id'));                  
			});


			function removeSmilesRow(idnum) {
				console.log(idnum);
				$("#formrow"+idnum).remove();
			}
		</script>
    </body>
</html>